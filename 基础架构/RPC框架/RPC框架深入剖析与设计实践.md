# RPC框架深入剖析与设计实践

## RPC 实现原理深入分析

### RPC 定义

### RPC 作用

* 屏蔽组包解包
* 屏蔽数据发送/接收
* 提高开发效率
* 业务发展的必然产物

### RPC 核心组成

* 远程方法对象代理
* 连接管理
* 序列化/反序列化
* 寻址与负载均衡

### RPC调用方式

* 同步调用
* 异步调用

### RPC 调用过程

远程代理 -> 序列化 -> 网络传输 -> 反序列化

![RPC调用过程](images/RPC调用过程.png)

## 精简版 RPC 调用代码实现

### 如果没有RPC

如果没有RPC框架支持，实现远程调用需要做哪些事情？

![如果没有RPC](images/如果没有RPC.png)



### 设计用户服务

* 功能需求：用户信息管理 CRUD
* 调用方式：TCP长连接同步交互
* 协议：自定义协议

#### 序列化协议

远程调用涉及数据的传输，就会涉及组包和解包，需要调用方和服务方约定的数据格式，即序列化协议

<img src="G:\docsify\study-notes\架构服务技术基础\images\序列化协议.png" alt="序列化协议" style="zoom:45%;" />

* version 版本号。解决升级问题
* cmd 命令，用数字映射操作
* magic 魔数，全局统一，解决误连接问题





## RPC 服务消费方核心功能设计实现

数据传输、序列化/反序列化、客户端代理类实现、



!> Consumer 连接管理、负载均衡、请求路由、超时处理、健康检查

!> Provider 队列/线程池、超时丢弃、优雅关闭、过载保护



## RPC 服务提供方核心功能设计实现

## RPC 高级功能剖析



## 主流 RPC 产品对比分析



## Dubbo 实现原理剖析



## Dubbo 实现商品列表页服务



## 设计实践作业

